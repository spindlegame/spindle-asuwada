<?php
// This script and data application were generated by AppGini 5.94
// Download AppGini for free from https://bigprof.com/appgini/download/

	$currDir = dirname(__FILE__);
	include_once("{$currDir}/lib.php");
	@include_once("{$currDir}/hooks/hist_storydynamic.php");
	include_once("{$currDir}/hist_storydynamic_dml.php");

	// mm: can the current member access this page?
	$perm = getTablePermissions('hist_storydynamic');
	if(!$perm['access']) {
		echo error_message($Translation['tableAccessDenied'], false);
		echo '<script>setTimeout(function() { window.location = "index.php?signOut=1"; }, 2000);</script>';
		exit;
	}

	$x = new DataList;
	$x->TableName = 'hist_storydynamic';

	// Fields that can be displayed in the table view
	$x->QueryFieldsTV = [
		"`hist_storydynamic`.`id`" => "id",
		"IF(    CHAR_LENGTH(`hist_story1`.`id`) || CHAR_LENGTH(`hist_story1`.`story_title`), CONCAT_WS('',   `hist_story1`.`id`, ' - ', `hist_story1`.`story_title`), '') /* Historia */" => "hist_story",
		"IF(    CHAR_LENGTH(`bio_story1`.`id`) || CHAR_LENGTH(`bio_story1`.`agent_name`), CONCAT_WS('',   `bio_story1`.`id`, ' - ', `bio_story1`.`agent_name`), '') /* Biograf&#237;a del personaje principal */" => "bio_story_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_character1`.`character`) || CHAR_LENGTH(`hist_chr1`.`agent_name`), CONCAT_WS('',   `class_dramatica_character1`.`character`, ' - ', `hist_chr1`.`agent_name`), '') /* Personaje principal */" => "hist_chr_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_throughline1`.`throughline`), CONCAT_WS('',   `class_dramatica_throughline1`.`throughline`), '') /* Punto est&#225;tico del MC */" => "storystatic_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_character2`.`character`) || CHAR_LENGTH(`bio_chr1`.`agent_name`), CONCAT_WS('',   `class_dramatica_character2`.`character`, ' agent:', `bio_chr1`.`agent_name`), '') /* Personaje biogr&#225;fico */" => "story_chr_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_themes1`.`theme`), CONCAT_WS('',   `class_dramatica_themes1`.`theme`), '') /* Problema MC */" => "mc_problem",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints41`.`term`), CONCAT_WS('',   `class_dynamicstorypoints41`.`term`), '') /* Resoluci&#243;n MC */" => "mc_resolve",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints42`.`term`), CONCAT_WS('',   `class_dynamicstorypoints42`.`term`), '') /* Crecimiento MC */" => "mc_growth",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints43`.`term`), CONCAT_WS('',   `class_dynamicstorypoints43`.`term`), '') /* Enfoque MC */" => "mc_approach",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints44`.`term`), CONCAT_WS('',   `class_dynamicstorypoints44`.`term`), '') /* Estilo de resolver problemas MC */" => "mc_ps_style",
		"IF(    CHAR_LENGTH(`bio_chr2`.`id`) || CHAR_LENGTH(`bio_chr2`.`character_name`), CONCAT_WS('',   `bio_chr2`.`id`, ' agent:', `bio_chr2`.`character_name`), '') /* Desarrollo de personaje del personaje de obst&#225;culo (IC) */" => "story_chr_ic",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints45`.`term`), CONCAT_WS('',   `class_dynamicstorypoints45`.`term`), '') /* Resoluci&#243;n IC */" => "ic_resolve",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints11`.`term`), CONCAT_WS('',   `class_dynamicstorypoints11`.`term`), '') /* Punto din&#225;mico clase 1 */" => "dp_cat1",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints21`.`term`), CONCAT_WS('',   `class_dynamicstorypoints21`.`term`), '') /* Punto din&#225;mico clase 2 */" => "dp_cat2",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints31`.`term`), CONCAT_WS('',   `class_dynamicstorypoints31`.`term`), '') /* Valor de punto din&#225;mico Conductor (Driver) */" => "dp_cat3_driver",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints46`.`term`), CONCAT_WS('',   `class_dynamicstorypoints46`.`term`), '') /* Conductor (Driver) OS */" => "os_driver",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints32`.`term`), CONCAT_WS('',   `class_dynamicstorypoints32`.`term`), '') /* Valor de punto din&#225;mico L&#237;mite */" => "dp_cat3_limit",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints47`.`term`), CONCAT_WS('',   `class_dynamicstorypoints47`.`term`), '') /* L&#237;mite OS */" => "os_limit",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints33`.`term`), CONCAT_WS('',   `class_dynamicstorypoints33`.`term`), '') /* Valor de punto din&#225;mico Desenlace (Outcome) */" => "dp_cat3_outcome",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints48`.`term`), CONCAT_WS('',   `class_dynamicstorypoints48`.`term`), '') /* Desenlace OS */" => "os_outcome",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints34`.`term`), CONCAT_WS('',   `class_dynamicstorypoints34`.`term`), '') /* Valor de punto din&#225;mico Sentencia (Judgement) */" => "dp_cat3_judgement",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints49`.`term`), CONCAT_WS('',   `class_dynamicstorypoints49`.`term`), '') /* Sentencia OS */" => "os_judgement",
		"IF(    CHAR_LENGTH(`class_dramatica_domain1`.`domain`), CONCAT_WS('',   `class_dramatica_domain1`.`domain`), '') /* Dominio de objetivo OS */" => "os_goal_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern1`.`concern`), CONCAT_WS('',   `class_dramatica_concern1`.`concern`), '') /* Aspecto (Concern) OS */" => "os_goal_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain2`.`domain`), CONCAT_WS('',   `class_dramatica_domain2`.`domain`), '') /* Dominio de consecuencia OS */" => "os_consequence_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern2`.`concern`), CONCAT_WS('',   `class_dramatica_concern2`.`concern`), '') /* Aspecto de consecuencia OS */" => "os_consequence_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain3`.`domain`), CONCAT_WS('',   `class_dramatica_domain3`.`domain`), '') /* Dominio de coste OS */" => "os_cost_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern3`.`concern`), CONCAT_WS('',   `class_dramatica_concern3`.`concern`), '') /* Aspecto de coste OS */" => "os_cost_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain4`.`domain`), CONCAT_WS('',   `class_dramatica_domain4`.`domain`), '') /* Dominio de dividendo OS */" => "os_dividend_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern4`.`concern`), CONCAT_WS('',   `class_dramatica_concern4`.`concern`), '') /* Aspecto de dividendo OS */" => "os_dividend_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain5`.`domain`), CONCAT_WS('',   `class_dramatica_domain5`.`domain`), '') /* Dominio de requisitos OS */" => "os_requirements_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern5`.`concern`), CONCAT_WS('',   `class_dramatica_concern5`.`concern`), '') /* Aspecto de requisitos OS */" => "os_requirements_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain6`.`domain`), CONCAT_WS('',   `class_dramatica_domain6`.`domain`), '') /* Dominio de prerequisitos OS */" => "os_prerequesites_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern6`.`concern`), CONCAT_WS('',   `class_dramatica_concern6`.`concern`), '') /* Aspecto de prerequisitos OS */" => "os_prerequesites_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain7`.`domain`), CONCAT_WS('',   `class_dramatica_domain7`.`domain`), '') /* Dominio de la precondici&#243;n OS */" => "os_preconditions_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern7`.`concern`), CONCAT_WS('',   `class_dramatica_concern7`.`concern`), '') /* Aspecto de la precondici&#243;n OS */" => "os_preconditions_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain8`.`domain`), CONCAT_WS('',   `class_dramatica_domain8`.`domain`), '') /* Dominio de la preaviso OS */" => "os_forewarnings_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern8`.`concern`), CONCAT_WS('',   `class_dramatica_concern8`.`concern`), '') /* Aspecto de la preaviso OS */" => "os_forewarnings_concern",
	];
	// mapping incoming sort by requests to actual query fields
	$x->SortFields = [
		1 => '`hist_storydynamic`.`id`',
		2 => 2,
		3 => 3,
		4 => 4,
		5 => 5,
		6 => 6,
		7 => 7,
		8 => 8,
		9 => 9,
		10 => 10,
		11 => 11,
		12 => 12,
		13 => 13,
		14 => '`class_dynamicstorypoints11`.`term`',
		15 => '`class_dynamicstorypoints21`.`term`',
		16 => '`class_dynamicstorypoints31`.`term`',
		17 => '`class_dynamicstorypoints46`.`term`',
		18 => '`class_dynamicstorypoints32`.`term`',
		19 => '`class_dynamicstorypoints47`.`term`',
		20 => '`class_dynamicstorypoints33`.`term`',
		21 => '`class_dynamicstorypoints48`.`term`',
		22 => '`class_dynamicstorypoints34`.`term`',
		23 => '`class_dynamicstorypoints49`.`term`',
		24 => 24,
		25 => 25,
		26 => '`class_dramatica_domain2`.`domain`',
		27 => '`class_dramatica_concern2`.`concern`',
		28 => '`class_dramatica_domain3`.`domain`',
		29 => '`class_dramatica_concern3`.`concern`',
		30 => '`class_dramatica_domain4`.`domain`',
		31 => '`class_dramatica_concern4`.`concern`',
		32 => '`class_dramatica_domain5`.`domain`',
		33 => '`class_dramatica_concern5`.`concern`',
		34 => '`class_dramatica_domain6`.`domain`',
		35 => '`class_dramatica_concern6`.`concern`',
		36 => '`class_dramatica_domain7`.`domain`',
		37 => '`class_dramatica_concern7`.`concern`',
		38 => '`class_dramatica_domain8`.`domain`',
		39 => '`class_dramatica_concern8`.`concern`',
	];

	// Fields that can be displayed in the csv file
	$x->QueryFieldsCSV = [
		"`hist_storydynamic`.`id`" => "id",
		"IF(    CHAR_LENGTH(`hist_story1`.`id`) || CHAR_LENGTH(`hist_story1`.`story_title`), CONCAT_WS('',   `hist_story1`.`id`, ' - ', `hist_story1`.`story_title`), '') /* Historia */" => "hist_story",
		"IF(    CHAR_LENGTH(`bio_story1`.`id`) || CHAR_LENGTH(`bio_story1`.`agent_name`), CONCAT_WS('',   `bio_story1`.`id`, ' - ', `bio_story1`.`agent_name`), '') /* Biograf&#237;a del personaje principal */" => "bio_story_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_character1`.`character`) || CHAR_LENGTH(`hist_chr1`.`agent_name`), CONCAT_WS('',   `class_dramatica_character1`.`character`, ' - ', `hist_chr1`.`agent_name`), '') /* Personaje principal */" => "hist_chr_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_throughline1`.`throughline`), CONCAT_WS('',   `class_dramatica_throughline1`.`throughline`), '') /* Punto est&#225;tico del MC */" => "storystatic_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_character2`.`character`) || CHAR_LENGTH(`bio_chr1`.`agent_name`), CONCAT_WS('',   `class_dramatica_character2`.`character`, ' agent:', `bio_chr1`.`agent_name`), '') /* Personaje biogr&#225;fico */" => "story_chr_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_themes1`.`theme`), CONCAT_WS('',   `class_dramatica_themes1`.`theme`), '') /* Problema MC */" => "mc_problem",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints41`.`term`), CONCAT_WS('',   `class_dynamicstorypoints41`.`term`), '') /* Resoluci&#243;n MC */" => "mc_resolve",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints42`.`term`), CONCAT_WS('',   `class_dynamicstorypoints42`.`term`), '') /* Crecimiento MC */" => "mc_growth",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints43`.`term`), CONCAT_WS('',   `class_dynamicstorypoints43`.`term`), '') /* Enfoque MC */" => "mc_approach",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints44`.`term`), CONCAT_WS('',   `class_dynamicstorypoints44`.`term`), '') /* Estilo de resolver problemas MC */" => "mc_ps_style",
		"IF(    CHAR_LENGTH(`bio_chr2`.`id`) || CHAR_LENGTH(`bio_chr2`.`character_name`), CONCAT_WS('',   `bio_chr2`.`id`, ' agent:', `bio_chr2`.`character_name`), '') /* Desarrollo de personaje del personaje de obst&#225;culo (IC) */" => "story_chr_ic",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints45`.`term`), CONCAT_WS('',   `class_dynamicstorypoints45`.`term`), '') /* Resoluci&#243;n IC */" => "ic_resolve",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints11`.`term`), CONCAT_WS('',   `class_dynamicstorypoints11`.`term`), '') /* Punto din&#225;mico clase 1 */" => "dp_cat1",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints21`.`term`), CONCAT_WS('',   `class_dynamicstorypoints21`.`term`), '') /* Punto din&#225;mico clase 2 */" => "dp_cat2",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints31`.`term`), CONCAT_WS('',   `class_dynamicstorypoints31`.`term`), '') /* Valor de punto din&#225;mico Conductor (Driver) */" => "dp_cat3_driver",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints46`.`term`), CONCAT_WS('',   `class_dynamicstorypoints46`.`term`), '') /* Conductor (Driver) OS */" => "os_driver",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints32`.`term`), CONCAT_WS('',   `class_dynamicstorypoints32`.`term`), '') /* Valor de punto din&#225;mico L&#237;mite */" => "dp_cat3_limit",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints47`.`term`), CONCAT_WS('',   `class_dynamicstorypoints47`.`term`), '') /* L&#237;mite OS */" => "os_limit",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints33`.`term`), CONCAT_WS('',   `class_dynamicstorypoints33`.`term`), '') /* Valor de punto din&#225;mico Desenlace (Outcome) */" => "dp_cat3_outcome",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints48`.`term`), CONCAT_WS('',   `class_dynamicstorypoints48`.`term`), '') /* Desenlace OS */" => "os_outcome",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints34`.`term`), CONCAT_WS('',   `class_dynamicstorypoints34`.`term`), '') /* Valor de punto din&#225;mico Sentencia (Judgement) */" => "dp_cat3_judgement",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints49`.`term`), CONCAT_WS('',   `class_dynamicstorypoints49`.`term`), '') /* Sentencia OS */" => "os_judgement",
		"IF(    CHAR_LENGTH(`class_dramatica_domain1`.`domain`), CONCAT_WS('',   `class_dramatica_domain1`.`domain`), '') /* Dominio de objetivo OS */" => "os_goal_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern1`.`concern`), CONCAT_WS('',   `class_dramatica_concern1`.`concern`), '') /* Aspecto (Concern) OS */" => "os_goal_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain2`.`domain`), CONCAT_WS('',   `class_dramatica_domain2`.`domain`), '') /* Dominio de consecuencia OS */" => "os_consequence_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern2`.`concern`), CONCAT_WS('',   `class_dramatica_concern2`.`concern`), '') /* Aspecto de consecuencia OS */" => "os_consequence_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain3`.`domain`), CONCAT_WS('',   `class_dramatica_domain3`.`domain`), '') /* Dominio de coste OS */" => "os_cost_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern3`.`concern`), CONCAT_WS('',   `class_dramatica_concern3`.`concern`), '') /* Aspecto de coste OS */" => "os_cost_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain4`.`domain`), CONCAT_WS('',   `class_dramatica_domain4`.`domain`), '') /* Dominio de dividendo OS */" => "os_dividend_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern4`.`concern`), CONCAT_WS('',   `class_dramatica_concern4`.`concern`), '') /* Aspecto de dividendo OS */" => "os_dividend_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain5`.`domain`), CONCAT_WS('',   `class_dramatica_domain5`.`domain`), '') /* Dominio de requisitos OS */" => "os_requirements_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern5`.`concern`), CONCAT_WS('',   `class_dramatica_concern5`.`concern`), '') /* Aspecto de requisitos OS */" => "os_requirements_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain6`.`domain`), CONCAT_WS('',   `class_dramatica_domain6`.`domain`), '') /* Dominio de prerequisitos OS */" => "os_prerequesites_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern6`.`concern`), CONCAT_WS('',   `class_dramatica_concern6`.`concern`), '') /* Aspecto de prerequisitos OS */" => "os_prerequesites_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain7`.`domain`), CONCAT_WS('',   `class_dramatica_domain7`.`domain`), '') /* Dominio de la precondici&#243;n OS */" => "os_preconditions_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern7`.`concern`), CONCAT_WS('',   `class_dramatica_concern7`.`concern`), '') /* Aspecto de la precondici&#243;n OS */" => "os_preconditions_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain8`.`domain`), CONCAT_WS('',   `class_dramatica_domain8`.`domain`), '') /* Dominio de la preaviso OS */" => "os_forewarnings_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern8`.`concern`), CONCAT_WS('',   `class_dramatica_concern8`.`concern`), '') /* Aspecto de la preaviso OS */" => "os_forewarnings_concern",
	];
	// Fields that can be filtered
	$x->QueryFieldsFilters = [
		"`hist_storydynamic`.`id`" => "ID",
		"IF(    CHAR_LENGTH(`hist_story1`.`id`) || CHAR_LENGTH(`hist_story1`.`story_title`), CONCAT_WS('',   `hist_story1`.`id`, ' - ', `hist_story1`.`story_title`), '') /* Historia */" => "Historia",
		"IF(    CHAR_LENGTH(`bio_story1`.`id`) || CHAR_LENGTH(`bio_story1`.`agent_name`), CONCAT_WS('',   `bio_story1`.`id`, ' - ', `bio_story1`.`agent_name`), '') /* Biograf&#237;a del personaje principal */" => "Biograf&#237;a del personaje principal",
		"IF(    CHAR_LENGTH(`class_dramatica_character1`.`character`) || CHAR_LENGTH(`hist_chr1`.`agent_name`), CONCAT_WS('',   `class_dramatica_character1`.`character`, ' - ', `hist_chr1`.`agent_name`), '') /* Personaje principal */" => "Personaje principal",
		"IF(    CHAR_LENGTH(`class_dramatica_throughline1`.`throughline`), CONCAT_WS('',   `class_dramatica_throughline1`.`throughline`), '') /* Punto est&#225;tico del MC */" => "Punto est&#225;tico del MC",
		"IF(    CHAR_LENGTH(`class_dramatica_character2`.`character`) || CHAR_LENGTH(`bio_chr1`.`agent_name`), CONCAT_WS('',   `class_dramatica_character2`.`character`, ' agent:', `bio_chr1`.`agent_name`), '') /* Personaje biogr&#225;fico */" => "Personaje biogr&#225;fico",
		"IF(    CHAR_LENGTH(`class_dramatica_themes1`.`theme`), CONCAT_WS('',   `class_dramatica_themes1`.`theme`), '') /* Problema MC */" => "Problema MC",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints41`.`term`), CONCAT_WS('',   `class_dynamicstorypoints41`.`term`), '') /* Resoluci&#243;n MC */" => "Resoluci&#243;n MC",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints42`.`term`), CONCAT_WS('',   `class_dynamicstorypoints42`.`term`), '') /* Crecimiento MC */" => "Crecimiento MC",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints43`.`term`), CONCAT_WS('',   `class_dynamicstorypoints43`.`term`), '') /* Enfoque MC */" => "Enfoque MC",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints44`.`term`), CONCAT_WS('',   `class_dynamicstorypoints44`.`term`), '') /* Estilo de resolver problemas MC */" => "Estilo de resolver problemas MC",
		"IF(    CHAR_LENGTH(`bio_chr2`.`id`) || CHAR_LENGTH(`bio_chr2`.`character_name`), CONCAT_WS('',   `bio_chr2`.`id`, ' agent:', `bio_chr2`.`character_name`), '') /* Desarrollo de personaje del personaje de obst&#225;culo (IC) */" => "Desarrollo de personaje del personaje de obst&#225;culo (IC)",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints45`.`term`), CONCAT_WS('',   `class_dynamicstorypoints45`.`term`), '') /* Resoluci&#243;n IC */" => "Resoluci&#243;n IC",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints11`.`term`), CONCAT_WS('',   `class_dynamicstorypoints11`.`term`), '') /* Punto din&#225;mico clase 1 */" => "Punto din&#225;mico clase 1",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints21`.`term`), CONCAT_WS('',   `class_dynamicstorypoints21`.`term`), '') /* Punto din&#225;mico clase 2 */" => "Punto din&#225;mico clase 2",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints31`.`term`), CONCAT_WS('',   `class_dynamicstorypoints31`.`term`), '') /* Valor de punto din&#225;mico Conductor (Driver) */" => "Valor de punto din&#225;mico Conductor (Driver)",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints46`.`term`), CONCAT_WS('',   `class_dynamicstorypoints46`.`term`), '') /* Conductor (Driver) OS */" => "Conductor (Driver) OS",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints32`.`term`), CONCAT_WS('',   `class_dynamicstorypoints32`.`term`), '') /* Valor de punto din&#225;mico L&#237;mite */" => "Valor de punto din&#225;mico L&#237;mite",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints47`.`term`), CONCAT_WS('',   `class_dynamicstorypoints47`.`term`), '') /* L&#237;mite OS */" => "L&#237;mite OS",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints33`.`term`), CONCAT_WS('',   `class_dynamicstorypoints33`.`term`), '') /* Valor de punto din&#225;mico Desenlace (Outcome) */" => "Valor de punto din&#225;mico Desenlace (Outcome)",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints48`.`term`), CONCAT_WS('',   `class_dynamicstorypoints48`.`term`), '') /* Desenlace OS */" => "Desenlace OS",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints34`.`term`), CONCAT_WS('',   `class_dynamicstorypoints34`.`term`), '') /* Valor de punto din&#225;mico Sentencia (Judgement) */" => "Valor de punto din&#225;mico Sentencia (Judgement)",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints49`.`term`), CONCAT_WS('',   `class_dynamicstorypoints49`.`term`), '') /* Sentencia OS */" => "Sentencia OS",
		"IF(    CHAR_LENGTH(`class_dramatica_domain1`.`domain`), CONCAT_WS('',   `class_dramatica_domain1`.`domain`), '') /* Dominio de objetivo OS */" => "Dominio de objetivo OS",
		"IF(    CHAR_LENGTH(`class_dramatica_concern1`.`concern`), CONCAT_WS('',   `class_dramatica_concern1`.`concern`), '') /* Aspecto (Concern) OS */" => "Aspecto (Concern) OS",
		"IF(    CHAR_LENGTH(`class_dramatica_domain2`.`domain`), CONCAT_WS('',   `class_dramatica_domain2`.`domain`), '') /* Dominio de consecuencia OS */" => "Dominio de consecuencia OS",
		"IF(    CHAR_LENGTH(`class_dramatica_concern2`.`concern`), CONCAT_WS('',   `class_dramatica_concern2`.`concern`), '') /* Aspecto de consecuencia OS */" => "Aspecto de consecuencia OS",
		"IF(    CHAR_LENGTH(`class_dramatica_domain3`.`domain`), CONCAT_WS('',   `class_dramatica_domain3`.`domain`), '') /* Dominio de coste OS */" => "Dominio de coste OS",
		"IF(    CHAR_LENGTH(`class_dramatica_concern3`.`concern`), CONCAT_WS('',   `class_dramatica_concern3`.`concern`), '') /* Aspecto de coste OS */" => "Aspecto de coste OS",
		"IF(    CHAR_LENGTH(`class_dramatica_domain4`.`domain`), CONCAT_WS('',   `class_dramatica_domain4`.`domain`), '') /* Dominio de dividendo OS */" => "Dominio de dividendo OS",
		"IF(    CHAR_LENGTH(`class_dramatica_concern4`.`concern`), CONCAT_WS('',   `class_dramatica_concern4`.`concern`), '') /* Aspecto de dividendo OS */" => "Aspecto de dividendo OS",
		"IF(    CHAR_LENGTH(`class_dramatica_domain5`.`domain`), CONCAT_WS('',   `class_dramatica_domain5`.`domain`), '') /* Dominio de requisitos OS */" => "Dominio de requisitos OS",
		"IF(    CHAR_LENGTH(`class_dramatica_concern5`.`concern`), CONCAT_WS('',   `class_dramatica_concern5`.`concern`), '') /* Aspecto de requisitos OS */" => "Aspecto de requisitos OS",
		"IF(    CHAR_LENGTH(`class_dramatica_domain6`.`domain`), CONCAT_WS('',   `class_dramatica_domain6`.`domain`), '') /* Dominio de prerequisitos OS */" => "Dominio de prerequisitos OS",
		"IF(    CHAR_LENGTH(`class_dramatica_concern6`.`concern`), CONCAT_WS('',   `class_dramatica_concern6`.`concern`), '') /* Aspecto de prerequisitos OS */" => "Aspecto de prerequisitos OS",
		"IF(    CHAR_LENGTH(`class_dramatica_domain7`.`domain`), CONCAT_WS('',   `class_dramatica_domain7`.`domain`), '') /* Dominio de la precondici&#243;n OS */" => "Dominio de la precondici&#243;n OS",
		"IF(    CHAR_LENGTH(`class_dramatica_concern7`.`concern`), CONCAT_WS('',   `class_dramatica_concern7`.`concern`), '') /* Aspecto de la precondici&#243;n OS */" => "Aspecto de la precondici&#243;n OS",
		"IF(    CHAR_LENGTH(`class_dramatica_domain8`.`domain`), CONCAT_WS('',   `class_dramatica_domain8`.`domain`), '') /* Dominio de la preaviso OS */" => "Dominio de la preaviso OS",
		"IF(    CHAR_LENGTH(`class_dramatica_concern8`.`concern`), CONCAT_WS('',   `class_dramatica_concern8`.`concern`), '') /* Aspecto de la preaviso OS */" => "Aspecto de la preaviso OS",
	];

	// Fields that can be quick searched
	$x->QueryFieldsQS = [
		"`hist_storydynamic`.`id`" => "id",
		"IF(    CHAR_LENGTH(`hist_story1`.`id`) || CHAR_LENGTH(`hist_story1`.`story_title`), CONCAT_WS('',   `hist_story1`.`id`, ' - ', `hist_story1`.`story_title`), '') /* Historia */" => "hist_story",
		"IF(    CHAR_LENGTH(`bio_story1`.`id`) || CHAR_LENGTH(`bio_story1`.`agent_name`), CONCAT_WS('',   `bio_story1`.`id`, ' - ', `bio_story1`.`agent_name`), '') /* Biograf&#237;a del personaje principal */" => "bio_story_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_character1`.`character`) || CHAR_LENGTH(`hist_chr1`.`agent_name`), CONCAT_WS('',   `class_dramatica_character1`.`character`, ' - ', `hist_chr1`.`agent_name`), '') /* Personaje principal */" => "hist_chr_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_throughline1`.`throughline`), CONCAT_WS('',   `class_dramatica_throughline1`.`throughline`), '') /* Punto est&#225;tico del MC */" => "storystatic_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_character2`.`character`) || CHAR_LENGTH(`bio_chr1`.`agent_name`), CONCAT_WS('',   `class_dramatica_character2`.`character`, ' agent:', `bio_chr1`.`agent_name`), '') /* Personaje biogr&#225;fico */" => "story_chr_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_themes1`.`theme`), CONCAT_WS('',   `class_dramatica_themes1`.`theme`), '') /* Problema MC */" => "mc_problem",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints41`.`term`), CONCAT_WS('',   `class_dynamicstorypoints41`.`term`), '') /* Resoluci&#243;n MC */" => "mc_resolve",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints42`.`term`), CONCAT_WS('',   `class_dynamicstorypoints42`.`term`), '') /* Crecimiento MC */" => "mc_growth",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints43`.`term`), CONCAT_WS('',   `class_dynamicstorypoints43`.`term`), '') /* Enfoque MC */" => "mc_approach",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints44`.`term`), CONCAT_WS('',   `class_dynamicstorypoints44`.`term`), '') /* Estilo de resolver problemas MC */" => "mc_ps_style",
		"IF(    CHAR_LENGTH(`bio_chr2`.`id`) || CHAR_LENGTH(`bio_chr2`.`character_name`), CONCAT_WS('',   `bio_chr2`.`id`, ' agent:', `bio_chr2`.`character_name`), '') /* Desarrollo de personaje del personaje de obst&#225;culo (IC) */" => "story_chr_ic",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints45`.`term`), CONCAT_WS('',   `class_dynamicstorypoints45`.`term`), '') /* Resoluci&#243;n IC */" => "ic_resolve",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints11`.`term`), CONCAT_WS('',   `class_dynamicstorypoints11`.`term`), '') /* Punto din&#225;mico clase 1 */" => "dp_cat1",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints21`.`term`), CONCAT_WS('',   `class_dynamicstorypoints21`.`term`), '') /* Punto din&#225;mico clase 2 */" => "dp_cat2",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints31`.`term`), CONCAT_WS('',   `class_dynamicstorypoints31`.`term`), '') /* Valor de punto din&#225;mico Conductor (Driver) */" => "dp_cat3_driver",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints46`.`term`), CONCAT_WS('',   `class_dynamicstorypoints46`.`term`), '') /* Conductor (Driver) OS */" => "os_driver",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints32`.`term`), CONCAT_WS('',   `class_dynamicstorypoints32`.`term`), '') /* Valor de punto din&#225;mico L&#237;mite */" => "dp_cat3_limit",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints47`.`term`), CONCAT_WS('',   `class_dynamicstorypoints47`.`term`), '') /* L&#237;mite OS */" => "os_limit",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints33`.`term`), CONCAT_WS('',   `class_dynamicstorypoints33`.`term`), '') /* Valor de punto din&#225;mico Desenlace (Outcome) */" => "dp_cat3_outcome",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints48`.`term`), CONCAT_WS('',   `class_dynamicstorypoints48`.`term`), '') /* Desenlace OS */" => "os_outcome",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints34`.`term`), CONCAT_WS('',   `class_dynamicstorypoints34`.`term`), '') /* Valor de punto din&#225;mico Sentencia (Judgement) */" => "dp_cat3_judgement",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints49`.`term`), CONCAT_WS('',   `class_dynamicstorypoints49`.`term`), '') /* Sentencia OS */" => "os_judgement",
		"IF(    CHAR_LENGTH(`class_dramatica_domain1`.`domain`), CONCAT_WS('',   `class_dramatica_domain1`.`domain`), '') /* Dominio de objetivo OS */" => "os_goal_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern1`.`concern`), CONCAT_WS('',   `class_dramatica_concern1`.`concern`), '') /* Aspecto (Concern) OS */" => "os_goal_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain2`.`domain`), CONCAT_WS('',   `class_dramatica_domain2`.`domain`), '') /* Dominio de consecuencia OS */" => "os_consequence_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern2`.`concern`), CONCAT_WS('',   `class_dramatica_concern2`.`concern`), '') /* Aspecto de consecuencia OS */" => "os_consequence_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain3`.`domain`), CONCAT_WS('',   `class_dramatica_domain3`.`domain`), '') /* Dominio de coste OS */" => "os_cost_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern3`.`concern`), CONCAT_WS('',   `class_dramatica_concern3`.`concern`), '') /* Aspecto de coste OS */" => "os_cost_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain4`.`domain`), CONCAT_WS('',   `class_dramatica_domain4`.`domain`), '') /* Dominio de dividendo OS */" => "os_dividend_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern4`.`concern`), CONCAT_WS('',   `class_dramatica_concern4`.`concern`), '') /* Aspecto de dividendo OS */" => "os_dividend_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain5`.`domain`), CONCAT_WS('',   `class_dramatica_domain5`.`domain`), '') /* Dominio de requisitos OS */" => "os_requirements_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern5`.`concern`), CONCAT_WS('',   `class_dramatica_concern5`.`concern`), '') /* Aspecto de requisitos OS */" => "os_requirements_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain6`.`domain`), CONCAT_WS('',   `class_dramatica_domain6`.`domain`), '') /* Dominio de prerequisitos OS */" => "os_prerequesites_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern6`.`concern`), CONCAT_WS('',   `class_dramatica_concern6`.`concern`), '') /* Aspecto de prerequisitos OS */" => "os_prerequesites_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain7`.`domain`), CONCAT_WS('',   `class_dramatica_domain7`.`domain`), '') /* Dominio de la precondici&#243;n OS */" => "os_preconditions_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern7`.`concern`), CONCAT_WS('',   `class_dramatica_concern7`.`concern`), '') /* Aspecto de la precondici&#243;n OS */" => "os_preconditions_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain8`.`domain`), CONCAT_WS('',   `class_dramatica_domain8`.`domain`), '') /* Dominio de la preaviso OS */" => "os_forewarnings_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern8`.`concern`), CONCAT_WS('',   `class_dramatica_concern8`.`concern`), '') /* Aspecto de la preaviso OS */" => "os_forewarnings_concern",
	];

	// Lookup fields that can be used as filterers
	$x->filterers = ['hist_story' => 'Historia', 'bio_story_mc' => 'Biograf&#237;a del personaje principal', 'hist_chr_mc' => 'Personaje principal', 'storystatic_mc' => 'Punto est&#225;tico del MC', 'story_chr_mc' => 'Personaje biogr&#225;fico', 'mc_problem' => 'Problema MC', 'mc_resolve' => 'Resoluci&#243;n MC', 'mc_growth' => 'Crecimiento MC', 'mc_approach' => 'Enfoque MC', 'mc_ps_style' => 'Estilo de resolver problemas MC', 'story_chr_ic' => 'Desarrollo de personaje del personaje de obst&#225;culo (IC)', 'ic_resolve' => 'Resoluci&#243;n IC', 'dp_cat1' => 'Punto din&#225;mico clase 1', 'dp_cat2' => 'Punto din&#225;mico clase 2', 'dp_cat3_driver' => 'Valor de punto din&#225;mico Conductor (Driver)', 'os_driver' => 'Conductor (Driver) OS', 'dp_cat3_limit' => 'Valor de punto din&#225;mico L&#237;mite', 'os_limit' => 'L&#237;mite OS', 'dp_cat3_outcome' => 'Valor de punto din&#225;mico Desenlace (Outcome)', 'os_outcome' => 'Desenlace OS', 'dp_cat3_judgement' => 'Valor de punto din&#225;mico Sentencia (Judgement)', 'os_judgement' => 'Sentencia OS', 'os_goal_domain' => 'Dominio de objetivo OS', 'os_goal_concern' => 'Aspecto (Concern) OS', 'os_consequence_domain' => 'Dominio de consecuencia OS', 'os_consequence_concern' => 'Aspecto de consecuencia OS', 'os_cost_domain' => 'Dominio de coste OS', 'os_cost_concern' => 'Aspecto de coste OS', 'os_dividend_domain' => 'Dominio de dividendo OS', 'os_dividend_concern' => 'Aspecto de dividendo OS', 'os_requirements_domain' => 'Dominio de requisitos OS', 'os_requirements_concern' => 'Aspecto de requisitos OS', 'os_prerequesites_domain' => 'Dominio de prerequisitos OS', 'os_prerequesites_concern' => 'Aspecto de prerequisitos OS', 'os_preconditions_domain' => 'Dominio de la precondici&#243;n OS', 'os_preconditions_concern' => 'Aspecto de la precondici&#243;n OS', 'os_forewarnings_domain' => 'Dominio de la preaviso OS', 'os_forewarnings_concern' => 'Aspecto de la preaviso OS', ];

	$x->QueryFrom = "`hist_storydynamic` LEFT JOIN `hist_story` as hist_story1 ON `hist_story1`.`id`=`hist_storydynamic`.`hist_story` LEFT JOIN `bio_story` as bio_story1 ON `bio_story1`.`id`=`hist_storydynamic`.`bio_story_mc` LEFT JOIN `hist_chr` as hist_chr1 ON `hist_chr1`.`id`=`hist_storydynamic`.`hist_chr_mc` LEFT JOIN `class_dramatica_character` as class_dramatica_character1 ON `class_dramatica_character1`.`id`=`hist_chr1`.`story_character` LEFT JOIN `bio_storystatic` as bio_storystatic1 ON `bio_storystatic1`.`id`=`hist_storydynamic`.`storystatic_mc` LEFT JOIN `class_dramatica_throughline` as class_dramatica_throughline1 ON `class_dramatica_throughline1`.`id`=`bio_storystatic1`.`throughline` LEFT JOIN `bio_chr` as bio_chr1 ON `bio_chr1`.`id`=`hist_storydynamic`.`story_chr_mc` LEFT JOIN `class_dramatica_character` as class_dramatica_character2 ON `class_dramatica_character2`.`id`=`bio_chr1`.`bio_character` LEFT JOIN `bio_storystatic` as bio_storystatic2 ON `bio_storystatic2`.`id`=`hist_storydynamic`.`mc_problem` LEFT JOIN `class_dramatica_themes` as class_dramatica_themes1 ON `class_dramatica_themes1`.`id`=`bio_storystatic2`.`problem` LEFT JOIN `bio_chr_dev` as bio_chr_dev1 ON `bio_chr_dev1`.`id`=`hist_storydynamic`.`mc_resolve` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints41 ON `class_dynamicstorypoints41`.`id`=`bio_chr_dev1`.`mc_resolve` LEFT JOIN `bio_chr_dev` as bio_chr_dev2 ON `bio_chr_dev2`.`id`=`hist_storydynamic`.`mc_growth` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints42 ON `class_dynamicstorypoints42`.`id`=`bio_chr_dev2`.`mc_growth` LEFT JOIN `bio_chr_dev` as bio_chr_dev3 ON `bio_chr_dev3`.`id`=`hist_storydynamic`.`mc_approach` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints43 ON `class_dynamicstorypoints43`.`id`=`bio_chr_dev3`.`mc_approach` LEFT JOIN `bio_chr_dev` as bio_chr_dev4 ON `bio_chr_dev4`.`id`=`hist_storydynamic`.`mc_ps_style` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints44 ON `class_dynamicstorypoints44`.`id`=`bio_chr_dev4`.`mc_ps_style` LEFT JOIN `bio_chr` as bio_chr2 ON `bio_chr2`.`id`=`hist_storydynamic`.`story_chr_ic` LEFT JOIN `bio_chr_dev` as bio_chr_dev5 ON `bio_chr_dev5`.`id`=`hist_storydynamic`.`ic_resolve` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints45 ON `class_dynamicstorypoints45`.`id`=`bio_chr_dev5`.`mc_resolve` LEFT JOIN `class_dynamicstorypoints1` as class_dynamicstorypoints11 ON `class_dynamicstorypoints11`.`id`=`hist_storydynamic`.`dp_cat1` LEFT JOIN `class_dynamicstorypoints2` as class_dynamicstorypoints21 ON `class_dynamicstorypoints21`.`id`=`hist_storydynamic`.`dp_cat2` LEFT JOIN `class_dynamicstorypoints3` as class_dynamicstorypoints31 ON `class_dynamicstorypoints31`.`id`=`hist_storydynamic`.`dp_cat3_driver` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints46 ON `class_dynamicstorypoints46`.`id`=`hist_storydynamic`.`os_driver` LEFT JOIN `class_dynamicstorypoints3` as class_dynamicstorypoints32 ON `class_dynamicstorypoints32`.`id`=`hist_storydynamic`.`dp_cat3_limit` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints47 ON `class_dynamicstorypoints47`.`id`=`hist_storydynamic`.`os_limit` LEFT JOIN `class_dynamicstorypoints3` as class_dynamicstorypoints33 ON `class_dynamicstorypoints33`.`id`=`hist_storydynamic`.`dp_cat3_outcome` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints48 ON `class_dynamicstorypoints48`.`id`=`hist_storydynamic`.`os_outcome` LEFT JOIN `class_dynamicstorypoints3` as class_dynamicstorypoints34 ON `class_dynamicstorypoints34`.`id`=`hist_storydynamic`.`dp_cat3_judgement` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints49 ON `class_dynamicstorypoints49`.`id`=`hist_storydynamic`.`os_judgement` LEFT JOIN `bio_storystatic` as bio_storystatic3 ON `bio_storystatic3`.`id`=`hist_storydynamic`.`os_goal_domain` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain1 ON `class_dramatica_domain1`.`id`=`bio_storystatic3`.`throughline_domain` LEFT JOIN `bio_storystatic` as bio_storystatic4 ON `bio_storystatic4`.`id`=`hist_storydynamic`.`os_goal_concern` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern1 ON `class_dramatica_concern1`.`id`=`bio_storystatic4`.`concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain2 ON `class_dramatica_domain2`.`id`=`hist_storydynamic`.`os_consequence_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern2 ON `class_dramatica_concern2`.`id`=`hist_storydynamic`.`os_consequence_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain3 ON `class_dramatica_domain3`.`id`=`hist_storydynamic`.`os_cost_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern3 ON `class_dramatica_concern3`.`id`=`hist_storydynamic`.`os_cost_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain4 ON `class_dramatica_domain4`.`id`=`hist_storydynamic`.`os_dividend_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern4 ON `class_dramatica_concern4`.`id`=`hist_storydynamic`.`os_dividend_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain5 ON `class_dramatica_domain5`.`id`=`hist_storydynamic`.`os_requirements_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern5 ON `class_dramatica_concern5`.`id`=`hist_storydynamic`.`os_requirements_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain6 ON `class_dramatica_domain6`.`id`=`hist_storydynamic`.`os_prerequesites_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern6 ON `class_dramatica_concern6`.`id`=`hist_storydynamic`.`os_prerequesites_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain7 ON `class_dramatica_domain7`.`id`=`hist_storydynamic`.`os_preconditions_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern7 ON `class_dramatica_concern7`.`id`=`hist_storydynamic`.`os_preconditions_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain8 ON `class_dramatica_domain8`.`id`=`hist_storydynamic`.`os_forewarnings_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern8 ON `class_dramatica_concern8`.`id`=`hist_storydynamic`.`os_forewarnings_concern` ";
	$x->QueryWhere = '';
	$x->QueryOrder = '';

	$x->AllowSelection = 1;
	$x->HideTableView = ($perm['view'] == 0 ? 1 : 0);
	$x->AllowDelete = $perm['delete'];
	$x->AllowMassDelete = (getLoggedAdmin() !== false);
	$x->AllowInsert = $perm['insert'];
	$x->AllowUpdate = $perm['edit'];
	$x->SeparateDV = 1;
	$x->AllowDeleteOfParents = 0;
	$x->AllowFilters = 1;
	$x->AllowSavingFilters = 1;
	$x->AllowSorting = 1;
	$x->AllowNavigation = 1;
	$x->AllowPrinting = 1;
	$x->AllowPrintingDV = 1;
	$x->AllowCSV = 1;
	$x->RecordsPerPage = 10;
	$x->QuickSearch = 1;
	$x->QuickSearchText = $Translation['quick search'];
	$x->ScriptFileName = 'hist_storydynamic_view.php';
	$x->RedirectAfterInsert = 'hist_storydynamic_view.php?SelectedID=#ID#';
	$x->TableTitle = 'Puntos din&#225;micos de biograf&#237;a';
	$x->TableIcon = 'resources/table_icons/areachart.png';
	$x->PrimaryKey = '`hist_storydynamic`.`id`';

	$x->ColWidth = [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, ];
	$x->ColCaption = ['ID', 'Historia', 'Biograf&#237;a del personaje principal', 'Personaje principal', 'Punto est&#225;tico del MC', 'Personaje biogr&#225;fico', 'Problema MC', 'Resoluci&#243;n MC', 'Crecimiento MC', 'Enfoque MC', 'Estilo de resolver problemas MC', 'Desarrollo de personaje del personaje de obst&#225;culo (IC)', 'Resoluci&#243;n IC', 'Punto din&#225;mico clase 1', 'Punto din&#225;mico clase 2', 'Valor de punto din&#225;mico Conductor (Driver)', 'Conductor (Driver) OS', 'Valor de punto din&#225;mico L&#237;mite', 'L&#237;mite OS', 'Valor de punto din&#225;mico Desenlace (Outcome)', 'Desenlace OS', 'Valor de punto din&#225;mico Sentencia (Judgement)', 'Sentencia OS', 'Dominio de objetivo OS', 'Aspecto (Concern) OS', 'Dominio de consecuencia OS', 'Aspecto de consecuencia OS', 'Dominio de coste OS', 'Aspecto de coste OS', 'Dominio de dividendo OS', 'Aspecto de dividendo OS', 'Dominio de requisitos OS', 'Aspecto de requisitos OS', 'Dominio de prerequisitos OS', 'Aspecto de prerequisitos OS', 'Dominio de la precondici&#243;n OS', 'Aspecto de la precondici&#243;n OS', 'Dominio de la preaviso OS', 'Aspecto de la preaviso OS', ];
	$x->ColFieldName = ['id', 'hist_story', 'bio_story_mc', 'hist_chr_mc', 'storystatic_mc', 'story_chr_mc', 'mc_problem', 'mc_resolve', 'mc_growth', 'mc_approach', 'mc_ps_style', 'story_chr_ic', 'ic_resolve', 'dp_cat1', 'dp_cat2', 'dp_cat3_driver', 'os_driver', 'dp_cat3_limit', 'os_limit', 'dp_cat3_outcome', 'os_outcome', 'dp_cat3_judgement', 'os_judgement', 'os_goal_domain', 'os_goal_concern', 'os_consequence_domain', 'os_consequence_concern', 'os_cost_domain', 'os_cost_concern', 'os_dividend_domain', 'os_dividend_concern', 'os_requirements_domain', 'os_requirements_concern', 'os_prerequesites_domain', 'os_prerequesites_concern', 'os_preconditions_domain', 'os_preconditions_concern', 'os_forewarnings_domain', 'os_forewarnings_concern', ];
	$x->ColNumber  = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, ];

	// template paths below are based on the app main directory
	$x->Template = 'templates/hist_storydynamic_templateTV.html';
	$x->SelectedTemplate = 'templates/hist_storydynamic_templateTVS.html';
	$x->TemplateDV = 'templates/hist_storydynamic_templateDV.html';
	$x->TemplateDVP = 'templates/hist_storydynamic_templateDVP.html';

	$x->ShowTableHeader = 1;
	$x->TVClasses = "";
	$x->DVClasses = "";
	$x->HasCalculatedFields = false;
	$x->AllowConsoleLog = false;
	$x->AllowDVNavigation = true;

	// mm: build the query based on current member's permissions
	$DisplayRecords = $_REQUEST['DisplayRecords'];
	if(!in_array($DisplayRecords, ['user', 'group'])) { $DisplayRecords = 'all'; }
	if($perm['view'] == 1 || ($perm['view'] > 1 && $DisplayRecords == 'user' && !$_REQUEST['NoFilter_x'])) { // view owner only
		$x->QueryFrom .= ', `membership_userrecords`';
		$x->QueryWhere = "WHERE `hist_storydynamic`.`id`=`membership_userrecords`.`pkValue` AND `membership_userrecords`.`tableName`='hist_storydynamic' AND LCASE(`membership_userrecords`.`memberID`)='" . getLoggedMemberID() . "'";
	} elseif($perm['view'] == 2 || ($perm['view'] > 2 && $DisplayRecords == 'group' && !$_REQUEST['NoFilter_x'])) { // view group only
		$x->QueryFrom .= ', `membership_userrecords`';
		$x->QueryWhere = "WHERE `hist_storydynamic`.`id`=`membership_userrecords`.`pkValue` AND `membership_userrecords`.`tableName`='hist_storydynamic' AND `membership_userrecords`.`groupID`='" . getLoggedGroupID() . "'";
	} elseif($perm['view'] == 3) { // view all
		// no further action
	} elseif($perm['view'] == 0) { // view none
		$x->QueryFields = ['Not enough permissions' => 'NEP'];
		$x->QueryFrom = '`hist_storydynamic`';
		$x->QueryWhere = '';
		$x->DefaultSortField = '';
	}
	// hook: hist_storydynamic_init
	$render = true;
	if(function_exists('hist_storydynamic_init')) {
		$args = [];
		$render = hist_storydynamic_init($x, getMemberInfo(), $args);
	}

	if($render) $x->Render();

	// hook: hist_storydynamic_header
	$headerCode = '';
	if(function_exists('hist_storydynamic_header')) {
		$args = [];
		$headerCode = hist_storydynamic_header($x->ContentType, getMemberInfo(), $args);
	}

	if(!$headerCode) {
		include_once("{$currDir}/header.php"); 
	} else {
		ob_start();
		include_once("{$currDir}/header.php");
		echo str_replace('<%%HEADER%%>', ob_get_clean(), $headerCode);
	}

	echo $x->HTML;

	// hook: hist_storydynamic_footer
	$footerCode = '';
	if(function_exists('hist_storydynamic_footer')) {
		$args = [];
		$footerCode = hist_storydynamic_footer($x->ContentType, getMemberInfo(), $args);
	}

	if(!$footerCode) {
		include_once("{$currDir}/footer.php"); 
	} else {
		ob_start();
		include_once("{$currDir}/footer.php");
		echo str_replace('<%%FOOTER%%>', ob_get_clean(), $footerCode);
	}
