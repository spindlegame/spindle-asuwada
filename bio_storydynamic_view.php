<?php
// This script and data application were generated by AppGini 5.94
// Download AppGini for free from https://bigprof.com/appgini/download/

	$currDir = dirname(__FILE__);
	include_once("{$currDir}/lib.php");
	@include_once("{$currDir}/hooks/bio_storydynamic.php");
	include_once("{$currDir}/bio_storydynamic_dml.php");

	// mm: can the current member access this page?
	$perm = getTablePermissions('bio_storydynamic');
	if(!$perm['access']) {
		echo error_message($Translation['tableAccessDenied'], false);
		echo '<script>setTimeout(function() { window.location = "index.php?signOut=1"; }, 2000);</script>';
		exit;
	}

	$x = new DataList;
	$x->TableName = 'bio_storydynamic';

	// Fields that can be displayed in the table view
	$x->QueryFieldsTV = [
		"`bio_storydynamic`.`id`" => "id",
		"IF(    CHAR_LENGTH(`bio_story1`.`id`) || CHAR_LENGTH(`bio_story1`.`story_title`), CONCAT_WS('',   `bio_story1`.`id`, `bio_story1`.`story_title`), '') /* Story */" => "story",
		"IF(    CHAR_LENGTH(`class_dramatica_throughline1`.`throughline`), CONCAT_WS('',   `class_dramatica_throughline1`.`throughline`), '') /* Static Storypoints MC */" => "storystatic_mc",
		"IF(    CHAR_LENGTH(`bio_chr1`.`character_name`) || CHAR_LENGTH(`bio_chr1`.`agent_name`), CONCAT_WS('',   `bio_chr1`.`character_name`, ' agent:', `bio_chr1`.`agent_name`), '') /* MC from Chr. Dev. */" => "story_chr_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_themes1`.`theme`), CONCAT_WS('',   `class_dramatica_themes1`.`theme`), '') /* MC problem */" => "mc_problem",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints41`.`term`), CONCAT_WS('',   `class_dynamicstorypoints41`.`term`), '') /* MC resolve */" => "mc_resolve",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints42`.`term`), CONCAT_WS('',   `class_dynamicstorypoints42`.`term`), '') /* MC growth */" => "mc_growth",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints43`.`term`), CONCAT_WS('',   `class_dynamicstorypoints43`.`term`), '') /* MC approach */" => "mc_approach",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints44`.`term`), CONCAT_WS('',   `class_dynamicstorypoints44`.`term`), '') /* MC PS style */" => "mc_ps_style",
		"IF(    CHAR_LENGTH(`bio_chr2`.`id`) || CHAR_LENGTH(`bio_chr2`.`character_name`), CONCAT_WS('',   `bio_chr2`.`id`, ' agent:', `bio_chr2`.`character_name`), '') /* IC from Chr. Dev. */" => "story_chr_ic",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints45`.`term`), CONCAT_WS('',   `class_dynamicstorypoints45`.`term`), '') /* IC resolve */" => "ic_resolve",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints11`.`term`), CONCAT_WS('',   `class_dramatica_storypoints11`.`term`), '') /* Dynamic storypoint Class 1 */" => "dp_cat1",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints21`.`term`), CONCAT_WS('',   `class_dramatica_storypoints21`.`term`), '') /* Dynamic storypoint Class 2 */" => "dp_cat2",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints31`.`term`), CONCAT_WS('',   `class_dramatica_storypoints31`.`term`), '') /* Dynamic storypoint value Driver */" => "dp_cat3_driver",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints46`.`term`), CONCAT_WS('',   `class_dynamicstorypoints46`.`term`), '') /* OS driver */" => "os_driver",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints32`.`term`), CONCAT_WS('',   `class_dramatica_storypoints32`.`term`), '') /* Dynamic storypoint value Limit */" => "dp_cat3_limit",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints47`.`term`), CONCAT_WS('',   `class_dynamicstorypoints47`.`term`), '') /* OS limit */" => "os_limit",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints33`.`term`), CONCAT_WS('',   `class_dramatica_storypoints33`.`term`), '') /* Dynamic storypoint value Outcome */" => "dp_cat3_outcome",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints48`.`term`), CONCAT_WS('',   `class_dynamicstorypoints48`.`term`), '') /* OS outcome */" => "os_outcome",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints34`.`term`), CONCAT_WS('',   `class_dramatica_storypoints34`.`term`), '') /* Dynamic storypoint value Judgement */" => "dp_cat3_judgement",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints49`.`term`), CONCAT_WS('',   `class_dynamicstorypoints49`.`term`), '') /* OS judgement */" => "os_judgement",
		"IF(    CHAR_LENGTH(`class_dramatica_domain1`.`domain`), CONCAT_WS('',   `class_dramatica_domain1`.`domain`), '') /* OS goal domain */" => "os_goal_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern8`.`concern`), CONCAT_WS('',   `class_dramatica_concern8`.`concern`), '') /* OS goal concern */" => "os_goal_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain2`.`domain`), CONCAT_WS('',   `class_dramatica_domain2`.`domain`), '') /* OS consquence domain */" => "os_consequence_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern1`.`concern`), CONCAT_WS('',   `class_dramatica_concern1`.`concern`), '') /* OS consequence concern */" => "os_consequence_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain3`.`domain`), CONCAT_WS('',   `class_dramatica_domain3`.`domain`), '') /* OS cost domain */" => "os_cost_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern2`.`concern`), CONCAT_WS('',   `class_dramatica_concern2`.`concern`), '') /* OS cost concern */" => "os_cost_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain4`.`domain`), CONCAT_WS('',   `class_dramatica_domain4`.`domain`), '') /* OS dividend domain */" => "os_dividend_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern3`.`concern`), CONCAT_WS('',   `class_dramatica_concern3`.`concern`), '') /* OS dividend concern */" => "os_dividend_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain5`.`domain`), CONCAT_WS('',   `class_dramatica_domain5`.`domain`), '') /* OS requirements domain */" => "os_requirements_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern4`.`concern`), CONCAT_WS('',   `class_dramatica_concern4`.`concern`), '') /* OS requirements concern */" => "os_requirements_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain6`.`domain`), CONCAT_WS('',   `class_dramatica_domain6`.`domain`), '') /* OS prerequisites domain */" => "os_prerequesites_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern5`.`concern`), CONCAT_WS('',   `class_dramatica_concern5`.`concern`), '') /* OS prerequisites concern */" => "os_prerequesites_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain7`.`domain`), CONCAT_WS('',   `class_dramatica_domain7`.`domain`), '') /* OS preconditions domain */" => "os_preconditions_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern6`.`concern`), CONCAT_WS('',   `class_dramatica_concern6`.`concern`), '') /* OS preconditions concern */" => "os_preconditions_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain8`.`domain`), CONCAT_WS('',   `class_dramatica_domain8`.`domain`), '') /* OS forewarnings domain */" => "os_forewarnings_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern7`.`concern`), CONCAT_WS('',   `class_dramatica_concern7`.`concern`), '') /* OS forewarnings concern */" => "os_forewarnings_concern",
	];
	// mapping incoming sort by requests to actual query fields
	$x->SortFields = [
		1 => '`bio_storydynamic`.`id`',
		2 => 2,
		3 => 3,
		4 => 4,
		5 => 5,
		6 => 6,
		7 => 7,
		8 => 8,
		9 => 9,
		10 => 10,
		11 => 11,
		12 => '`class_dramatica_storypoints11`.`term`',
		13 => '`class_dramatica_storypoints21`.`term`',
		14 => '`class_dramatica_storypoints31`.`term`',
		15 => '`class_dynamicstorypoints46`.`term`',
		16 => '`class_dramatica_storypoints32`.`term`',
		17 => '`class_dynamicstorypoints47`.`term`',
		18 => '`class_dramatica_storypoints33`.`term`',
		19 => '`class_dynamicstorypoints48`.`term`',
		20 => '`class_dramatica_storypoints34`.`term`',
		21 => '`class_dynamicstorypoints49`.`term`',
		22 => 22,
		23 => 23,
		24 => '`class_dramatica_domain2`.`domain`',
		25 => '`class_dramatica_concern1`.`concern`',
		26 => '`class_dramatica_domain3`.`domain`',
		27 => '`class_dramatica_concern2`.`concern`',
		28 => '`class_dramatica_domain4`.`domain`',
		29 => '`class_dramatica_concern3`.`concern`',
		30 => '`class_dramatica_domain5`.`domain`',
		31 => '`class_dramatica_concern4`.`concern`',
		32 => '`class_dramatica_domain6`.`domain`',
		33 => '`class_dramatica_concern5`.`concern`',
		34 => '`class_dramatica_domain7`.`domain`',
		35 => '`class_dramatica_concern6`.`concern`',
		36 => '`class_dramatica_domain8`.`domain`',
		37 => '`class_dramatica_concern7`.`concern`',
	];

	// Fields that can be displayed in the csv file
	$x->QueryFieldsCSV = [
		"`bio_storydynamic`.`id`" => "id",
		"IF(    CHAR_LENGTH(`bio_story1`.`id`) || CHAR_LENGTH(`bio_story1`.`story_title`), CONCAT_WS('',   `bio_story1`.`id`, `bio_story1`.`story_title`), '') /* Story */" => "story",
		"IF(    CHAR_LENGTH(`class_dramatica_throughline1`.`throughline`), CONCAT_WS('',   `class_dramatica_throughline1`.`throughline`), '') /* Static Storypoints MC */" => "storystatic_mc",
		"IF(    CHAR_LENGTH(`bio_chr1`.`character_name`) || CHAR_LENGTH(`bio_chr1`.`agent_name`), CONCAT_WS('',   `bio_chr1`.`character_name`, ' agent:', `bio_chr1`.`agent_name`), '') /* MC from Chr. Dev. */" => "story_chr_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_themes1`.`theme`), CONCAT_WS('',   `class_dramatica_themes1`.`theme`), '') /* MC problem */" => "mc_problem",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints41`.`term`), CONCAT_WS('',   `class_dynamicstorypoints41`.`term`), '') /* MC resolve */" => "mc_resolve",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints42`.`term`), CONCAT_WS('',   `class_dynamicstorypoints42`.`term`), '') /* MC growth */" => "mc_growth",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints43`.`term`), CONCAT_WS('',   `class_dynamicstorypoints43`.`term`), '') /* MC approach */" => "mc_approach",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints44`.`term`), CONCAT_WS('',   `class_dynamicstorypoints44`.`term`), '') /* MC PS style */" => "mc_ps_style",
		"IF(    CHAR_LENGTH(`bio_chr2`.`id`) || CHAR_LENGTH(`bio_chr2`.`character_name`), CONCAT_WS('',   `bio_chr2`.`id`, ' agent:', `bio_chr2`.`character_name`), '') /* IC from Chr. Dev. */" => "story_chr_ic",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints45`.`term`), CONCAT_WS('',   `class_dynamicstorypoints45`.`term`), '') /* IC resolve */" => "ic_resolve",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints11`.`term`), CONCAT_WS('',   `class_dramatica_storypoints11`.`term`), '') /* Dynamic storypoint Class 1 */" => "dp_cat1",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints21`.`term`), CONCAT_WS('',   `class_dramatica_storypoints21`.`term`), '') /* Dynamic storypoint Class 2 */" => "dp_cat2",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints31`.`term`), CONCAT_WS('',   `class_dramatica_storypoints31`.`term`), '') /* Dynamic storypoint value Driver */" => "dp_cat3_driver",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints46`.`term`), CONCAT_WS('',   `class_dynamicstorypoints46`.`term`), '') /* OS driver */" => "os_driver",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints32`.`term`), CONCAT_WS('',   `class_dramatica_storypoints32`.`term`), '') /* Dynamic storypoint value Limit */" => "dp_cat3_limit",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints47`.`term`), CONCAT_WS('',   `class_dynamicstorypoints47`.`term`), '') /* OS limit */" => "os_limit",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints33`.`term`), CONCAT_WS('',   `class_dramatica_storypoints33`.`term`), '') /* Dynamic storypoint value Outcome */" => "dp_cat3_outcome",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints48`.`term`), CONCAT_WS('',   `class_dynamicstorypoints48`.`term`), '') /* OS outcome */" => "os_outcome",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints34`.`term`), CONCAT_WS('',   `class_dramatica_storypoints34`.`term`), '') /* Dynamic storypoint value Judgement */" => "dp_cat3_judgement",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints49`.`term`), CONCAT_WS('',   `class_dynamicstorypoints49`.`term`), '') /* OS judgement */" => "os_judgement",
		"IF(    CHAR_LENGTH(`class_dramatica_domain1`.`domain`), CONCAT_WS('',   `class_dramatica_domain1`.`domain`), '') /* OS goal domain */" => "os_goal_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern8`.`concern`), CONCAT_WS('',   `class_dramatica_concern8`.`concern`), '') /* OS goal concern */" => "os_goal_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain2`.`domain`), CONCAT_WS('',   `class_dramatica_domain2`.`domain`), '') /* OS consquence domain */" => "os_consequence_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern1`.`concern`), CONCAT_WS('',   `class_dramatica_concern1`.`concern`), '') /* OS consequence concern */" => "os_consequence_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain3`.`domain`), CONCAT_WS('',   `class_dramatica_domain3`.`domain`), '') /* OS cost domain */" => "os_cost_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern2`.`concern`), CONCAT_WS('',   `class_dramatica_concern2`.`concern`), '') /* OS cost concern */" => "os_cost_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain4`.`domain`), CONCAT_WS('',   `class_dramatica_domain4`.`domain`), '') /* OS dividend domain */" => "os_dividend_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern3`.`concern`), CONCAT_WS('',   `class_dramatica_concern3`.`concern`), '') /* OS dividend concern */" => "os_dividend_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain5`.`domain`), CONCAT_WS('',   `class_dramatica_domain5`.`domain`), '') /* OS requirements domain */" => "os_requirements_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern4`.`concern`), CONCAT_WS('',   `class_dramatica_concern4`.`concern`), '') /* OS requirements concern */" => "os_requirements_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain6`.`domain`), CONCAT_WS('',   `class_dramatica_domain6`.`domain`), '') /* OS prerequisites domain */" => "os_prerequesites_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern5`.`concern`), CONCAT_WS('',   `class_dramatica_concern5`.`concern`), '') /* OS prerequisites concern */" => "os_prerequesites_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain7`.`domain`), CONCAT_WS('',   `class_dramatica_domain7`.`domain`), '') /* OS preconditions domain */" => "os_preconditions_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern6`.`concern`), CONCAT_WS('',   `class_dramatica_concern6`.`concern`), '') /* OS preconditions concern */" => "os_preconditions_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain8`.`domain`), CONCAT_WS('',   `class_dramatica_domain8`.`domain`), '') /* OS forewarnings domain */" => "os_forewarnings_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern7`.`concern`), CONCAT_WS('',   `class_dramatica_concern7`.`concern`), '') /* OS forewarnings concern */" => "os_forewarnings_concern",
	];
	// Fields that can be filtered
	$x->QueryFieldsFilters = [
		"`bio_storydynamic`.`id`" => "ID",
		"IF(    CHAR_LENGTH(`bio_story1`.`id`) || CHAR_LENGTH(`bio_story1`.`story_title`), CONCAT_WS('',   `bio_story1`.`id`, `bio_story1`.`story_title`), '') /* Story */" => "Story",
		"IF(    CHAR_LENGTH(`class_dramatica_throughline1`.`throughline`), CONCAT_WS('',   `class_dramatica_throughline1`.`throughline`), '') /* Static Storypoints MC */" => "Static Storypoints MC",
		"IF(    CHAR_LENGTH(`bio_chr1`.`character_name`) || CHAR_LENGTH(`bio_chr1`.`agent_name`), CONCAT_WS('',   `bio_chr1`.`character_name`, ' agent:', `bio_chr1`.`agent_name`), '') /* MC from Chr. Dev. */" => "MC from Chr. Dev.",
		"IF(    CHAR_LENGTH(`class_dramatica_themes1`.`theme`), CONCAT_WS('',   `class_dramatica_themes1`.`theme`), '') /* MC problem */" => "MC problem",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints41`.`term`), CONCAT_WS('',   `class_dynamicstorypoints41`.`term`), '') /* MC resolve */" => "MC resolve",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints42`.`term`), CONCAT_WS('',   `class_dynamicstorypoints42`.`term`), '') /* MC growth */" => "MC growth",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints43`.`term`), CONCAT_WS('',   `class_dynamicstorypoints43`.`term`), '') /* MC approach */" => "MC approach",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints44`.`term`), CONCAT_WS('',   `class_dynamicstorypoints44`.`term`), '') /* MC PS style */" => "MC PS style",
		"IF(    CHAR_LENGTH(`bio_chr2`.`id`) || CHAR_LENGTH(`bio_chr2`.`character_name`), CONCAT_WS('',   `bio_chr2`.`id`, ' agent:', `bio_chr2`.`character_name`), '') /* IC from Chr. Dev. */" => "IC from Chr. Dev.",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints45`.`term`), CONCAT_WS('',   `class_dynamicstorypoints45`.`term`), '') /* IC resolve */" => "IC resolve",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints11`.`term`), CONCAT_WS('',   `class_dramatica_storypoints11`.`term`), '') /* Dynamic storypoint Class 1 */" => "Dynamic storypoint Class 1",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints21`.`term`), CONCAT_WS('',   `class_dramatica_storypoints21`.`term`), '') /* Dynamic storypoint Class 2 */" => "Dynamic storypoint Class 2",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints31`.`term`), CONCAT_WS('',   `class_dramatica_storypoints31`.`term`), '') /* Dynamic storypoint value Driver */" => "Dynamic storypoint value Driver",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints46`.`term`), CONCAT_WS('',   `class_dynamicstorypoints46`.`term`), '') /* OS driver */" => "OS driver",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints32`.`term`), CONCAT_WS('',   `class_dramatica_storypoints32`.`term`), '') /* Dynamic storypoint value Limit */" => "Dynamic storypoint value Limit",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints47`.`term`), CONCAT_WS('',   `class_dynamicstorypoints47`.`term`), '') /* OS limit */" => "OS limit",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints33`.`term`), CONCAT_WS('',   `class_dramatica_storypoints33`.`term`), '') /* Dynamic storypoint value Outcome */" => "Dynamic storypoint value Outcome",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints48`.`term`), CONCAT_WS('',   `class_dynamicstorypoints48`.`term`), '') /* OS outcome */" => "OS outcome",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints34`.`term`), CONCAT_WS('',   `class_dramatica_storypoints34`.`term`), '') /* Dynamic storypoint value Judgement */" => "Dynamic storypoint value Judgement",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints49`.`term`), CONCAT_WS('',   `class_dynamicstorypoints49`.`term`), '') /* OS judgement */" => "OS judgement",
		"IF(    CHAR_LENGTH(`class_dramatica_domain1`.`domain`), CONCAT_WS('',   `class_dramatica_domain1`.`domain`), '') /* OS goal domain */" => "OS goal domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern8`.`concern`), CONCAT_WS('',   `class_dramatica_concern8`.`concern`), '') /* OS goal concern */" => "OS goal concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain2`.`domain`), CONCAT_WS('',   `class_dramatica_domain2`.`domain`), '') /* OS consquence domain */" => "OS consquence domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern1`.`concern`), CONCAT_WS('',   `class_dramatica_concern1`.`concern`), '') /* OS consequence concern */" => "OS consequence concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain3`.`domain`), CONCAT_WS('',   `class_dramatica_domain3`.`domain`), '') /* OS cost domain */" => "OS cost domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern2`.`concern`), CONCAT_WS('',   `class_dramatica_concern2`.`concern`), '') /* OS cost concern */" => "OS cost concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain4`.`domain`), CONCAT_WS('',   `class_dramatica_domain4`.`domain`), '') /* OS dividend domain */" => "OS dividend domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern3`.`concern`), CONCAT_WS('',   `class_dramatica_concern3`.`concern`), '') /* OS dividend concern */" => "OS dividend concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain5`.`domain`), CONCAT_WS('',   `class_dramatica_domain5`.`domain`), '') /* OS requirements domain */" => "OS requirements domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern4`.`concern`), CONCAT_WS('',   `class_dramatica_concern4`.`concern`), '') /* OS requirements concern */" => "OS requirements concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain6`.`domain`), CONCAT_WS('',   `class_dramatica_domain6`.`domain`), '') /* OS prerequisites domain */" => "OS prerequisites domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern5`.`concern`), CONCAT_WS('',   `class_dramatica_concern5`.`concern`), '') /* OS prerequisites concern */" => "OS prerequisites concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain7`.`domain`), CONCAT_WS('',   `class_dramatica_domain7`.`domain`), '') /* OS preconditions domain */" => "OS preconditions domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern6`.`concern`), CONCAT_WS('',   `class_dramatica_concern6`.`concern`), '') /* OS preconditions concern */" => "OS preconditions concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain8`.`domain`), CONCAT_WS('',   `class_dramatica_domain8`.`domain`), '') /* OS forewarnings domain */" => "OS forewarnings domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern7`.`concern`), CONCAT_WS('',   `class_dramatica_concern7`.`concern`), '') /* OS forewarnings concern */" => "OS forewarnings concern",
	];

	// Fields that can be quick searched
	$x->QueryFieldsQS = [
		"`bio_storydynamic`.`id`" => "id",
		"IF(    CHAR_LENGTH(`bio_story1`.`id`) || CHAR_LENGTH(`bio_story1`.`story_title`), CONCAT_WS('',   `bio_story1`.`id`, `bio_story1`.`story_title`), '') /* Story */" => "story",
		"IF(    CHAR_LENGTH(`class_dramatica_throughline1`.`throughline`), CONCAT_WS('',   `class_dramatica_throughline1`.`throughline`), '') /* Static Storypoints MC */" => "storystatic_mc",
		"IF(    CHAR_LENGTH(`bio_chr1`.`character_name`) || CHAR_LENGTH(`bio_chr1`.`agent_name`), CONCAT_WS('',   `bio_chr1`.`character_name`, ' agent:', `bio_chr1`.`agent_name`), '') /* MC from Chr. Dev. */" => "story_chr_mc",
		"IF(    CHAR_LENGTH(`class_dramatica_themes1`.`theme`), CONCAT_WS('',   `class_dramatica_themes1`.`theme`), '') /* MC problem */" => "mc_problem",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints41`.`term`), CONCAT_WS('',   `class_dynamicstorypoints41`.`term`), '') /* MC resolve */" => "mc_resolve",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints42`.`term`), CONCAT_WS('',   `class_dynamicstorypoints42`.`term`), '') /* MC growth */" => "mc_growth",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints43`.`term`), CONCAT_WS('',   `class_dynamicstorypoints43`.`term`), '') /* MC approach */" => "mc_approach",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints44`.`term`), CONCAT_WS('',   `class_dynamicstorypoints44`.`term`), '') /* MC PS style */" => "mc_ps_style",
		"IF(    CHAR_LENGTH(`bio_chr2`.`id`) || CHAR_LENGTH(`bio_chr2`.`character_name`), CONCAT_WS('',   `bio_chr2`.`id`, ' agent:', `bio_chr2`.`character_name`), '') /* IC from Chr. Dev. */" => "story_chr_ic",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints45`.`term`), CONCAT_WS('',   `class_dynamicstorypoints45`.`term`), '') /* IC resolve */" => "ic_resolve",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints11`.`term`), CONCAT_WS('',   `class_dramatica_storypoints11`.`term`), '') /* Dynamic storypoint Class 1 */" => "dp_cat1",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints21`.`term`), CONCAT_WS('',   `class_dramatica_storypoints21`.`term`), '') /* Dynamic storypoint Class 2 */" => "dp_cat2",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints31`.`term`), CONCAT_WS('',   `class_dramatica_storypoints31`.`term`), '') /* Dynamic storypoint value Driver */" => "dp_cat3_driver",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints46`.`term`), CONCAT_WS('',   `class_dynamicstorypoints46`.`term`), '') /* OS driver */" => "os_driver",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints32`.`term`), CONCAT_WS('',   `class_dramatica_storypoints32`.`term`), '') /* Dynamic storypoint value Limit */" => "dp_cat3_limit",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints47`.`term`), CONCAT_WS('',   `class_dynamicstorypoints47`.`term`), '') /* OS limit */" => "os_limit",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints33`.`term`), CONCAT_WS('',   `class_dramatica_storypoints33`.`term`), '') /* Dynamic storypoint value Outcome */" => "dp_cat3_outcome",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints48`.`term`), CONCAT_WS('',   `class_dynamicstorypoints48`.`term`), '') /* OS outcome */" => "os_outcome",
		"IF(    CHAR_LENGTH(`class_dramatica_storypoints34`.`term`), CONCAT_WS('',   `class_dramatica_storypoints34`.`term`), '') /* Dynamic storypoint value Judgement */" => "dp_cat3_judgement",
		"IF(    CHAR_LENGTH(`class_dynamicstorypoints49`.`term`), CONCAT_WS('',   `class_dynamicstorypoints49`.`term`), '') /* OS judgement */" => "os_judgement",
		"IF(    CHAR_LENGTH(`class_dramatica_domain1`.`domain`), CONCAT_WS('',   `class_dramatica_domain1`.`domain`), '') /* OS goal domain */" => "os_goal_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern8`.`concern`), CONCAT_WS('',   `class_dramatica_concern8`.`concern`), '') /* OS goal concern */" => "os_goal_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain2`.`domain`), CONCAT_WS('',   `class_dramatica_domain2`.`domain`), '') /* OS consquence domain */" => "os_consequence_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern1`.`concern`), CONCAT_WS('',   `class_dramatica_concern1`.`concern`), '') /* OS consequence concern */" => "os_consequence_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain3`.`domain`), CONCAT_WS('',   `class_dramatica_domain3`.`domain`), '') /* OS cost domain */" => "os_cost_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern2`.`concern`), CONCAT_WS('',   `class_dramatica_concern2`.`concern`), '') /* OS cost concern */" => "os_cost_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain4`.`domain`), CONCAT_WS('',   `class_dramatica_domain4`.`domain`), '') /* OS dividend domain */" => "os_dividend_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern3`.`concern`), CONCAT_WS('',   `class_dramatica_concern3`.`concern`), '') /* OS dividend concern */" => "os_dividend_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain5`.`domain`), CONCAT_WS('',   `class_dramatica_domain5`.`domain`), '') /* OS requirements domain */" => "os_requirements_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern4`.`concern`), CONCAT_WS('',   `class_dramatica_concern4`.`concern`), '') /* OS requirements concern */" => "os_requirements_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain6`.`domain`), CONCAT_WS('',   `class_dramatica_domain6`.`domain`), '') /* OS prerequisites domain */" => "os_prerequesites_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern5`.`concern`), CONCAT_WS('',   `class_dramatica_concern5`.`concern`), '') /* OS prerequisites concern */" => "os_prerequesites_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain7`.`domain`), CONCAT_WS('',   `class_dramatica_domain7`.`domain`), '') /* OS preconditions domain */" => "os_preconditions_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern6`.`concern`), CONCAT_WS('',   `class_dramatica_concern6`.`concern`), '') /* OS preconditions concern */" => "os_preconditions_concern",
		"IF(    CHAR_LENGTH(`class_dramatica_domain8`.`domain`), CONCAT_WS('',   `class_dramatica_domain8`.`domain`), '') /* OS forewarnings domain */" => "os_forewarnings_domain",
		"IF(    CHAR_LENGTH(`class_dramatica_concern7`.`concern`), CONCAT_WS('',   `class_dramatica_concern7`.`concern`), '') /* OS forewarnings concern */" => "os_forewarnings_concern",
	];

	// Lookup fields that can be used as filterers
	$x->filterers = ['story' => 'Story', 'storystatic_mc' => 'Static Storypoints MC', 'story_chr_mc' => 'MC from Chr. Dev.', 'mc_problem' => 'MC problem', 'mc_resolve' => 'MC resolve', 'mc_growth' => 'MC growth', 'mc_approach' => 'MC approach', 'mc_ps_style' => 'MC PS style', 'story_chr_ic' => 'IC from Chr. Dev.', 'ic_resolve' => 'IC resolve', 'dp_cat1' => 'Dynamic storypoint Class 1', 'dp_cat2' => 'Dynamic storypoint Class 2', 'dp_cat3_driver' => 'Dynamic storypoint value Driver', 'os_driver' => 'OS driver', 'dp_cat3_limit' => 'Dynamic storypoint value Limit', 'os_limit' => 'OS limit', 'dp_cat3_outcome' => 'Dynamic storypoint value Outcome', 'os_outcome' => 'OS outcome', 'dp_cat3_judgement' => 'Dynamic storypoint value Judgement', 'os_judgement' => 'OS judgement', 'os_goal_domain' => 'OS goal domain', 'os_consequence_domain' => 'OS consquence domain', 'os_consequence_concern' => 'OS consequence concern', 'os_cost_domain' => 'OS cost domain', 'os_cost_concern' => 'OS cost concern', 'os_dividend_domain' => 'OS dividend domain', 'os_dividend_concern' => 'OS dividend concern', 'os_requirements_domain' => 'OS requirements domain', 'os_requirements_concern' => 'OS requirements concern', 'os_prerequesites_domain' => 'OS prerequisites domain', 'os_prerequesites_concern' => 'OS prerequisites concern', 'os_preconditions_domain' => 'OS preconditions domain', 'os_preconditions_concern' => 'OS preconditions concern', 'os_forewarnings_domain' => 'OS forewarnings domain', 'os_forewarnings_concern' => 'OS forewarnings concern', ];

	$x->QueryFrom = "`bio_storydynamic` LEFT JOIN `bio_story` as bio_story1 ON `bio_story1`.`id`=`bio_storydynamic`.`story` LEFT JOIN `bio_storystatic` as bio_storystatic1 ON `bio_storystatic1`.`id`=`bio_storydynamic`.`storystatic_mc` LEFT JOIN `class_dramatica_throughline` as class_dramatica_throughline1 ON `class_dramatica_throughline1`.`id`=`bio_storystatic1`.`throughline` LEFT JOIN `bio_chr` as bio_chr1 ON `bio_chr1`.`id`=`bio_storydynamic`.`story_chr_mc` LEFT JOIN `bio_storystatic` as bio_storystatic2 ON `bio_storystatic2`.`id`=`bio_storydynamic`.`mc_problem` LEFT JOIN `class_dramatica_themes` as class_dramatica_themes1 ON `class_dramatica_themes1`.`id`=`bio_storystatic2`.`problem` LEFT JOIN `bio_chr_dev` as bio_chr_dev1 ON `bio_chr_dev1`.`id`=`bio_storydynamic`.`mc_resolve` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints41 ON `class_dynamicstorypoints41`.`id`=`bio_chr_dev1`.`mc_resolve` LEFT JOIN `bio_chr_dev` as bio_chr_dev2 ON `bio_chr_dev2`.`id`=`bio_storydynamic`.`mc_growth` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints42 ON `class_dynamicstorypoints42`.`id`=`bio_chr_dev2`.`mc_growth` LEFT JOIN `bio_chr_dev` as bio_chr_dev3 ON `bio_chr_dev3`.`id`=`bio_storydynamic`.`mc_approach` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints43 ON `class_dynamicstorypoints43`.`id`=`bio_chr_dev3`.`mc_approach` LEFT JOIN `bio_chr_dev` as bio_chr_dev4 ON `bio_chr_dev4`.`id`=`bio_storydynamic`.`mc_ps_style` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints44 ON `class_dynamicstorypoints44`.`id`=`bio_chr_dev4`.`mc_ps_style` LEFT JOIN `bio_chr` as bio_chr2 ON `bio_chr2`.`id`=`bio_storydynamic`.`story_chr_ic` LEFT JOIN `bio_chr_dev` as bio_chr_dev5 ON `bio_chr_dev5`.`id`=`bio_storydynamic`.`ic_resolve` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints45 ON `class_dynamicstorypoints45`.`id`=`bio_chr_dev5`.`mc_resolve` LEFT JOIN `class_dramatica_storypoints1` as class_dramatica_storypoints11 ON `class_dramatica_storypoints11`.`id`=`bio_storydynamic`.`dp_cat1` LEFT JOIN `class_dramatica_storypoints2` as class_dramatica_storypoints21 ON `class_dramatica_storypoints21`.`id`=`bio_storydynamic`.`dp_cat2` LEFT JOIN `class_dramatica_storypoints3` as class_dramatica_storypoints31 ON `class_dramatica_storypoints31`.`id`=`bio_storydynamic`.`dp_cat3_driver` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints46 ON `class_dynamicstorypoints46`.`id`=`bio_storydynamic`.`os_driver` LEFT JOIN `class_dramatica_storypoints3` as class_dramatica_storypoints32 ON `class_dramatica_storypoints32`.`id`=`bio_storydynamic`.`dp_cat3_limit` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints47 ON `class_dynamicstorypoints47`.`id`=`bio_storydynamic`.`os_limit` LEFT JOIN `class_dramatica_storypoints3` as class_dramatica_storypoints33 ON `class_dramatica_storypoints33`.`id`=`bio_storydynamic`.`dp_cat3_outcome` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints48 ON `class_dynamicstorypoints48`.`id`=`bio_storydynamic`.`os_outcome` LEFT JOIN `class_dramatica_storypoints3` as class_dramatica_storypoints34 ON `class_dramatica_storypoints34`.`id`=`bio_storydynamic`.`dp_cat3_judgement` LEFT JOIN `class_dynamicstorypoints4` as class_dynamicstorypoints49 ON `class_dynamicstorypoints49`.`id`=`bio_storydynamic`.`os_judgement` LEFT JOIN `bio_storystatic` as bio_storystatic3 ON `bio_storystatic3`.`id`=`bio_storydynamic`.`os_goal_domain` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain1 ON `class_dramatica_domain1`.`id`=`bio_storystatic3`.`throughline_domain` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain2 ON `class_dramatica_domain2`.`id`=`bio_storydynamic`.`os_consequence_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern1 ON `class_dramatica_concern1`.`id`=`bio_storydynamic`.`os_consequence_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain3 ON `class_dramatica_domain3`.`id`=`bio_storydynamic`.`os_cost_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern2 ON `class_dramatica_concern2`.`id`=`bio_storydynamic`.`os_cost_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain4 ON `class_dramatica_domain4`.`id`=`bio_storydynamic`.`os_dividend_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern3 ON `class_dramatica_concern3`.`id`=`bio_storydynamic`.`os_dividend_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain5 ON `class_dramatica_domain5`.`id`=`bio_storydynamic`.`os_requirements_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern4 ON `class_dramatica_concern4`.`id`=`bio_storydynamic`.`os_requirements_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain6 ON `class_dramatica_domain6`.`id`=`bio_storydynamic`.`os_prerequesites_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern5 ON `class_dramatica_concern5`.`id`=`bio_storydynamic`.`os_prerequesites_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain7 ON `class_dramatica_domain7`.`id`=`bio_storydynamic`.`os_preconditions_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern6 ON `class_dramatica_concern6`.`id`=`bio_storydynamic`.`os_preconditions_concern` LEFT JOIN `class_dramatica_domain` as class_dramatica_domain8 ON `class_dramatica_domain8`.`id`=`bio_storydynamic`.`os_forewarnings_domain` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern7 ON `class_dramatica_concern7`.`id`=`bio_storydynamic`.`os_forewarnings_concern` LEFT JOIN `class_dramatica_concern` as class_dramatica_concern8 ON `class_dramatica_concern8`.`id`=`bio_storystatic1`.`concern` ";
	$x->QueryWhere = '';
	$x->QueryOrder = '';

	$x->AllowSelection = 1;
	$x->HideTableView = ($perm['view'] == 0 ? 1 : 0);
	$x->AllowDelete = $perm['delete'];
	$x->AllowMassDelete = (getLoggedAdmin() !== false);
	$x->AllowInsert = $perm['insert'];
	$x->AllowUpdate = $perm['edit'];
	$x->SeparateDV = 1;
	$x->AllowDeleteOfParents = 0;
	$x->AllowFilters = 1;
	$x->AllowSavingFilters = 1;
	$x->AllowSorting = 1;
	$x->AllowNavigation = 1;
	$x->AllowPrinting = 1;
	$x->AllowPrintingDV = 1;
	$x->AllowCSV = 1;
	$x->RecordsPerPage = 10;
	$x->QuickSearch = 1;
	$x->QuickSearchText = $Translation['quick search'];
	$x->ScriptFileName = 'bio_storydynamic_view.php';
	$x->RedirectAfterInsert = 'bio_storydynamic_view.php';
	$x->TableTitle = 'Bio dynamic storypoints';
	$x->TableIcon = 'resources/table_icons/areachart.png';
	$x->PrimaryKey = '`bio_storydynamic`.`id`';

	$x->ColWidth = [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, ];
	$x->ColCaption = ['ID', 'Story', 'Static Storypoints MC', 'MC from Chr. Dev.', 'MC problem', 'MC resolve', 'MC growth', 'MC approach', 'MC PS style', 'IC from Chr. Dev.', 'IC resolve', 'Dynamic storypoint Class 1', 'Dynamic storypoint Class 2', 'Dynamic storypoint value Driver', 'OS driver', 'Dynamic storypoint value Limit', 'OS limit', 'Dynamic storypoint value Outcome', 'OS outcome', 'Dynamic storypoint value Judgement', 'OS judgement', 'OS goal domain', 'OS goal concern', 'OS consquence domain', 'OS consequence concern', 'OS cost domain', 'OS cost concern', 'OS dividend domain', 'OS dividend concern', 'OS requirements domain', 'OS requirements concern', 'OS prerequisites domain', 'OS prerequisites concern', 'OS preconditions domain', 'OS preconditions concern', 'OS forewarnings domain', 'OS forewarnings concern', ];
	$x->ColFieldName = ['id', 'story', 'storystatic_mc', 'story_chr_mc', 'mc_problem', 'mc_resolve', 'mc_growth', 'mc_approach', 'mc_ps_style', 'story_chr_ic', 'ic_resolve', 'dp_cat1', 'dp_cat2', 'dp_cat3_driver', 'os_driver', 'dp_cat3_limit', 'os_limit', 'dp_cat3_outcome', 'os_outcome', 'dp_cat3_judgement', 'os_judgement', 'os_goal_domain', 'os_goal_concern', 'os_consequence_domain', 'os_consequence_concern', 'os_cost_domain', 'os_cost_concern', 'os_dividend_domain', 'os_dividend_concern', 'os_requirements_domain', 'os_requirements_concern', 'os_prerequesites_domain', 'os_prerequesites_concern', 'os_preconditions_domain', 'os_preconditions_concern', 'os_forewarnings_domain', 'os_forewarnings_concern', ];
	$x->ColNumber  = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, ];

	// template paths below are based on the app main directory
	$x->Template = 'templates/bio_storydynamic_templateTV.html';
	$x->SelectedTemplate = 'templates/bio_storydynamic_templateTVS.html';
	$x->TemplateDV = 'templates/bio_storydynamic_templateDV.html';
	$x->TemplateDVP = 'templates/bio_storydynamic_templateDVP.html';

	$x->ShowTableHeader = 1;
	$x->TVClasses = "";
	$x->DVClasses = "";
	$x->HasCalculatedFields = false;
	$x->AllowConsoleLog = false;
	$x->AllowDVNavigation = true;

	// mm: build the query based on current member's permissions
	$DisplayRecords = $_REQUEST['DisplayRecords'];
	if(!in_array($DisplayRecords, ['user', 'group'])) { $DisplayRecords = 'all'; }
	if($perm['view'] == 1 || ($perm['view'] > 1 && $DisplayRecords == 'user' && !$_REQUEST['NoFilter_x'])) { // view owner only
		$x->QueryFrom .= ', `membership_userrecords`';
		$x->QueryWhere = "WHERE `bio_storydynamic`.`id`=`membership_userrecords`.`pkValue` AND `membership_userrecords`.`tableName`='bio_storydynamic' AND LCASE(`membership_userrecords`.`memberID`)='" . getLoggedMemberID() . "'";
	} elseif($perm['view'] == 2 || ($perm['view'] > 2 && $DisplayRecords == 'group' && !$_REQUEST['NoFilter_x'])) { // view group only
		$x->QueryFrom .= ', `membership_userrecords`';
		$x->QueryWhere = "WHERE `bio_storydynamic`.`id`=`membership_userrecords`.`pkValue` AND `membership_userrecords`.`tableName`='bio_storydynamic' AND `membership_userrecords`.`groupID`='" . getLoggedGroupID() . "'";
	} elseif($perm['view'] == 3) { // view all
		// no further action
	} elseif($perm['view'] == 0) { // view none
		$x->QueryFields = ['Not enough permissions' => 'NEP'];
		$x->QueryFrom = '`bio_storydynamic`';
		$x->QueryWhere = '';
		$x->DefaultSortField = '';
	}
	// hook: bio_storydynamic_init
	$render = true;
	if(function_exists('bio_storydynamic_init')) {
		$args = [];
		$render = bio_storydynamic_init($x, getMemberInfo(), $args);
	}

	if($render) $x->Render();

	// hook: bio_storydynamic_header
	$headerCode = '';
	if(function_exists('bio_storydynamic_header')) {
		$args = [];
		$headerCode = bio_storydynamic_header($x->ContentType, getMemberInfo(), $args);
	}

	if(!$headerCode) {
		include_once("{$currDir}/header.php"); 
	} else {
		ob_start();
		include_once("{$currDir}/header.php");
		echo str_replace('<%%HEADER%%>', ob_get_clean(), $headerCode);
	}

	echo $x->HTML;

	// hook: bio_storydynamic_footer
	$footerCode = '';
	if(function_exists('bio_storydynamic_footer')) {
		$args = [];
		$footerCode = bio_storydynamic_footer($x->ContentType, getMemberInfo(), $args);
	}

	if(!$footerCode) {
		include_once("{$currDir}/footer.php"); 
	} else {
		ob_start();
		include_once("{$currDir}/footer.php");
		echo str_replace('<%%FOOTER%%>', ob_get_clean(), $footerCode);
	}
